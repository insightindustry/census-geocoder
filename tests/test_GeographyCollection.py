"""
***********************************
tests/test_GeographyCollection
***********************************

Tests for the :class:`GeographyCollection` class.

"""

import pytest
from tests.fixtures import input_files

from census_geocoder.geographies import GeographyCollection
from census_geocoder import constants, errors


@pytest.mark.parametrize('as_dict, error', [
    ({}, ValueError),
    ({
        "2020 Census ZIP Code Tabulation Areas": [{
            "GEOID": "20746",
            "CENTLAT": "+38.8366493",
            "AREAWATER": 47839,
            "BASENAME": "20746",
            "OID": "221704257714982",
            "ZCTA5": "20746",
            "LSADC": "Z5",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8364025",
            "NAME": "ZCTA5 20746",
            "OBJECTID": 1926,
            "CENTLON": "-076.9193615",
            "AREALAND": 19595655,
            "INTPTLON": "-076.9182650",
            "MTFCC": "G6350",
            "ZCTA5CC": "B5"
        }],
        "Counties": [{
            "GEOID": "24033",
            "CENTLAT": "+38.8293079",
            "AREAWATER": 41922695,
            "STATE": "24",
            "BASENAME": "Prince George's",
            "OID": "27590286309965",
            "LSADC": "06",
            "FUNCSTAT": "A",
            "INTPTLAT": "+38.8292778",
            "NAME": "Prince George's County",
            "OBJECTID": 1362,
            "CENTLON": "-076.8472801",
            "COUNTYCC": "H1",
            "COUNTYNS": "01714670",
            "AREALAND": 1250057213,
            "INTPTLON": "-076.8481880",
            "MTFCC": "G4020",
            "COUNTY": "033"
        }],
        "2010 Census Public Use Microdata Areas": [{
            "GEOID": "2401107",
            "CENTLAT": "+38.8056761",
            "AREAWATER": 9277681,
            "BASENAME": "Prince George's County (Southwest)--Oxon Hill, Hillcrest Heights & Temple Hills",
            "STATE": "24",
            "OID": "217404486465773",
            "LSADC": "P0",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8068379",
            "NAME": "Prince George's County (Southwest)--Oxon Hill, Hillcrest Heights & Temple Hills PUMA",
            "OBJECTID": 700,
            "CENTLON": "-076.9677486",
            "AREALAND": 80792925,
            "INTPTLON": "-076.9672061",
            "MTFCC": "G6120",
            "PUMA": "01107"
        }],
        "Unified School Districts": [{
            "LOGRADE": "PK",
            "GEOID": "2400510",
            "CENTLAT": "+38.8293079",
            "AREAWATER": 41922695,
            "STATE": "24",
            "BASENAME": "Prince George's County Public Schools",
            "OID": "28490286347139",
            "SDTYP": "",
            "LSADC": "00",
            "FUNCSTAT": "E",
            "INTPTLAT": "+38.8292778",
            "SDUNI": "00510",
            "NAME": "Prince George's County Public Schools",
            "OBJECTID": 4708,
            "CENTLON": "-076.8472801",
            "HIGRADE": "12",
            "AREALAND": 1250057213,
            "INTPTLON": "-076.8481880",
            "MTFCC": "G5420"
        }],
        "2020 Census Blocks": [{
            "SUFFIX": "",
            "GEOID": "240338024052004",
            "CENTLAT": "+38.8516945",
            "BLOCK": "2004",
            "AREAWATER": 2970,
            "STATE": "24",
            "BASENAME": "2004",
            "OID": "210701008482815",
            "LSADC": "BK",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8522266",
            "NAME": "Block 2004",
            "OBJECTID": 1361602,
            "TRACT": "802405",
            "CENTLON": "-076.9402961",
            "BLKGRP": "2",
            "AREALAND": 1745386,
            "INTPTLON": "-076.9378719",
            "MTFCC": "G5040",
            "LWBLKTYP": "B",
            "COUNTY": "033"
        }],
        "Metropolitan Divisions": [{
            "GEOID": "4790047894",
            "CENTLAT": "+38.6910254",
            "AREAWATER": 1074750940,
            "BASENAME": "Washington-Arlington-Alexandria, DC-VA-MD-WV",
            "OID": "2639013782256218",
            "LSADC": "M3",
            "METDIV": "47894",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.6930272",
            "NAME": "Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Division",
            "CSA": "548",
            "OBJECTID": 29,
            "CENTLON": "-077.5207028",
            "CBSA": "47900",
            "AREALAND": 14022157874,
            "INTPTLON": "-077.5216162",
            "MTFCC": "G3120"
        }],
        "States": [{
            "STATENS": "01714934",
            "GEOID": "24",
            "CENTLAT": "+38.9463607",
            "AREAWATER": 6979074857,
            "STATE": "24",
            "BASENAME": "Maryland",
            "STUSAB": "MD",
            "OID": "27490140608205",
            "LSADC": "00",
            "FUNCSTAT": "A",
            "INTPTLAT": "+38.9466584",
            "DIVISION": "5",
            "NAME": "Maryland",
            "REGION": "3",
            "OBJECTID": 5,
            "CENTLON": "-076.6789663",
            "AREALAND": 25151992308,
            "INTPTLON": "-076.6744939",
            "MTFCC": "G4000"
        }],
        "Census Block Groups": [{
            "GEOID": "240338024052",
            "CENTLAT": "+38.8538877",
            "AREAWATER": 8728,
            "STATE": "24",
            "BASENAME": "2",
            "OID": "20890286109972",
            "LSADC": "BG",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8507922",
            "NAME": "Block Group 2",
            "OBJECTID": 22857,
            "TRACT": "802405",
            "CENTLON": "-076.9390445",
            "BLKGRP": "2",
            "AREALAND": 3168459,
            "INTPTLON": "-076.9410126",
            "MTFCC": "G5030",
            "COUNTY": "033"
        }],
        "2018 State Legislative Districts - Upper": [{
            "GEOID": "24024",
            "CENTLAT": "+38.9214498",
            "AREAWATER": 462426,
            "STATE": "24",
            "BASENAME": "24",
            "OID": "212904691844680",
            "SLDU": "024",
            "LSADC": "LU",
            "FUNCSTAT": "N",
            "INTPTLAT": "+38.9213114",
            "NAME": "State Senate District 24",
            "OBJECTID": 1219,
            "CENTLON": "-076.8473589",
            "LSY": "2018",
            "AREALAND": 91755721,
            "INTPTLON": "-076.8477930",
            "MTFCC": "G5210",
            "LDTYP": "O"
        }],
        "Combined Statistical Areas": [{
            "GEOID": "548",
            "CENTLAT": "+39.0282802",
            "AREAWATER": 4067820538,
            "BASENAME": "Washington-Baltimore-Arlington, DC-MD-VA-WV-PA",
            "OID": "2619013782255247",
            "LSADC": "M0",
            "FUNCSTAT": "S",
            "INTPTLAT": "+39.0246056",
            "NAME": "Washington-Baltimore-Arlington, DC-MD-VA-WV-PA CSA",
            "OBJECTID": 171,
            "CSA": "548",
            "CENTLON": "-077.3083335",
            "INTPTLON": "-077.3105306",
            "AREALAND": 32735947122,
            "MTFCC": "G3100"
        }],
        "County Subdivisions": [{
            "COUSUB": "90524",
            "GEOID": "2403390524",
            "CENTLAT": "+38.8406376",
            "AREAWATER": 64586,
            "STATE": "24",
            "BASENAME": "6, Spauldings",
            "OID": "27690286313747",
            "LSADC": "28",
            "FUNCSTAT": "N",
            "INTPTLAT": "+38.8404712",
            "NAME": "District 6, Spauldings",
            "OBJECTID": 3899,
            "CENTLON": "-076.9085553",
            "COUSUBCC": "Z1",
            "AREALAND": 55544427,
            "INTPTLON": "-076.9057059",
            "MTFCC": "G4040",
            "COUSUBNS": "01929662",
            "COUNTY": "033"
        }],
        "Census Designated Places": [{
            "NECTAPCI": "N",
            "GEOID": "2475725",
            "CENTLAT": "+38.8491996",
            "AREAWATER": 8728,
            "STATE": "24",
            "BASENAME": "Suitland",
            "OID": "28090286317634",
            "LSADC": "57",
            "PLACE": "75725",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8486149",
            "NAME": "Suitland CDP",
            "OBJECTID": 5307,
            "PLACECC": "U1",
            "CENTLON": "-076.9224722",
            "CBSAPCI": "N",
            "AREALAND": 10997721,
            "INTPTLON": "-076.9225198",
            "PLACENS": "02652341",
            "MTFCC": "G4210"
        }],
        "2018 State Legislative Districts - Lower": [{
            "GEOID": "24024",
            "CENTLAT": "+38.9214498",
            "SLDL": "024",
            "AREAWATER": 462426,
            "STATE": "24",
            "BASENAME": "24",
            "OID": "213904691844919",
            "LSADC": "L5",
            "FUNCSTAT": "N",
            "INTPTLAT": "+38.9213114",
            "NAME": "State Legislative District 24",
            "OBJECTID": 3537,
            "CENTLON": "-076.8473589",
            "LSY": "2018",
            "AREALAND": 91755721,
            "INTPTLON": "-076.8477930",
            "MTFCC": "G5220",
            "LDTYP": "O"
        }],
        "Census Divisions": [{
            "GEOID": "5",
            "CENTLAT": "+33.9106293",
            "AREAWATER": 86335476111,
            "BASENAME": "South Atlantic",
            "OID": "2739020719808",
            "LSADC": "69",
            "FUNCSTAT": "S",
            "INTPTLAT": "+33.9116871",
            "DIVISION": "5",
            "REGION": "3",
            "NAME": "South Atlantic Division",
            "OBJECTID": 2,
            "CENTLON": "-080.9187908",
            "AREALAND": 687129423753,
            "INTPTLON": "-080.9155621",
            "MTFCC": "G1200"
        }],
        "116th Congressional Districts": [{
            "GEOID": "2404",
            "CENTLAT": "+38.9682049",
            "CDSESSN": "116",
            "AREAWATER": 48188249,
            "STATE": "24",
            "BASENAME": "4",
            "OID": "211904690760194",
            "LSADC": "C2",
            "FUNCSTAT": "N",
            "INTPTLAT": "+39.0562471",
            "NAME": "Congressional District 4",
            "OBJECTID": 258,
            "CENTLON": "-076.7454981",
            "AREALAND": 771268630,
            "INTPTLON": "-076.5924708",
            "CD116": "04",
            "MTFCC": "G5200"
        }],
        "Census Regions": [{
            "GEOID": "3",
            "CENTLAT": "+33.5458123",
            "AREAWATER": 148742585589,
            "BASENAME": "South",
            "OID": "2729020719822",
            "LSADC": "68",
            "FUNCSTAT": "S",
            "INTPTLAT": "+33.5528399",
            "REGION": "3",
            "NAME": "South Region",
            "OBJECTID": 1,
            "CENTLON": "-090.1661023",
            "AREALAND": 2249835530078,
            "INTPTLON": "-090.1649735",
            "MTFCC": "G1100"
        }],
        "Metropolitan Statistical Areas": [{
            "GEOID": "47900",
            "CENTLAT": "+38.7977350",
            "AREAWATER": 1128111563,
            "BASENAME": "Washington-Arlington-Alexandria, DC-VA-MD-WV",
            "OID": "2629013782256147",
            "LSADC": "M1",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.7982054",
            "NAME": "Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area",
            "CSA": "548",
            "OBJECTID": 909,
            "CENTLON": "-077.4863163",
            "CBSA": "47900",
            "AREALAND": 17010273437,
            "INTPTLON": "-077.4868816",
            "MTFCC": "G3110"
        }],
        "Census Tracts": [{
            "GEOID": "24033802405",
            "CENTLAT": "+38.8553715",
            "AREAWATER": 8728,
            "STATE": "24",
            "BASENAME": "8024.05",
            "OID": "20790286332785",
            "LSADC": "CT",
            "FUNCSTAT": "S",
            "INTPTLAT": "+38.8556709",
            "NAME": "Census Tract 8024.05",
            "OBJECTID": 82362,
            "TRACT": "802405",
            "CENTLON": "-076.9365872",
            "AREALAND": 3974775,
            "INTPTLON": "-076.9366990",
            "MTFCC": "G5020",
            "COUNTY": "033"
        }]
     }, None),
])
def test_from_dict(as_dict, error):
    if not error:
        result = GeographyCollection.from_dict(as_dict)
        assert result is not None
        assert isinstance(result, GeographyCollection) is True

    else:
        with pytest.raises(error):
            result = GeographyCollection.from_dict(as_dict)
